"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8024],{8024:(me,G,p)=>{p.r(G),p.d(G,{Tab1PageModule:()=>_e});var _=p(2112),T=p(1368),C=p(4716),k=p(4692),N=p(8244),m=p(1528),y=p(1740);class E{constructor(c){this.formBuilder=c}createForm(){return this.formBuilder.group({name:["",[C.AQ.required]],hometown:[""]})}}var e=p(4496),f=p(4552),I=p(5748),u=p(4688),b=p(1512),v=p(9552);let R=(()=>{var a;class c{constructor(t,n,r){this.auth=t,this.fireStore=n,this.storage=r}getNPCs(t,n,r){let s,l=(0,u.oV)(this.fireStore,`npcs/from_${this.auth.currentUser.email}_in_${r}/NPCData`);return""!=t&&(s=(0,u.kt)(l,(0,u.A9)("name",">=",t),(0,u.A9)("name","<=",t+"\uf8ff"))),""!==n&&(s=(0,u.kt)(s||l,(0,u.A9)("hometown","==",n))),(0,f.GK)(""!=n||""!=t?s:l)}getEmails(t){return(0,f.GK)((0,u.oV)(this.fireStore,`emails_in_${t}`))}getShared(t){return(0,f.GK)((0,u.oV)(this.fireStore,`npcs/from_${this.auth.currentUser.email}_in_${t}/sharedNPCData`))}uploadImage(t,n,r){var i=this;return(0,m.c)(function*(){const l=i.auth.currentUser,d=(0,I.IL)(i.storage,`uploads/${n}'s_avatar.png`);try{yield(0,b.K)(d,t.base64String,"base64");const h=yield(0,b.Kq)(d),g=(0,u.oV)(i.fireStore,`npcs/from_${l.email}_in_${r}/NPCData`),P=(0,f.UN)(g,n);return yield(0,u.gD)(P,{imageURL:h}),!0}catch{return null}})()}uploadNPC(t,n,r,i){var l=this;return(0,m.c)(function*(){const s=l.auth.currentUser,h=(0,I.IL)(l.storage,`uploads/${t}'s_avatar.png`);try{const g="",P="",O=(0,u.oV)(l.fireStore,`npcs/from_${s.email}_in_${i}/NPCData`);if(r){yield(0,b.K)(h,r.base64String,"base64");const ue=yield(0,b.Kq)(h);return yield(0,u.Sm)((0,f.UN)(O,t),{name:t,hometown:n,imageURL:ue,characterInfo:g,characterLink:P}),!0}return yield(0,u.Sm)((0,f.UN)(O,t),{name:t,hometown:n,imageURL:"",characterInfo:g,characterLink:P}),!0}catch(g){return console.log(g),null}})()}uploadSharedNPC(t,n,r,i,l,s){var d=this;return(0,m.c)(function*(){const h=d.auth.currentUser;try{const g=(0,u.oV)(d.fireStore,`npcs/from_${h.email}_in_${s}/NPCData`);return yield(0,u.Sm)((0,f.UN)(g,t),{name:t,hometown:n,imageURL:r,characterInfo:l,characterLink:i}),!0}catch(g){return console.log(g),null}})()}shareCharacter(t,n,r,i,l,s,d){var h=this;return(0,m.c)(function*(){if(""==t)return null;try{const g=(0,u.oV)(h.fireStore,`npcs/from_${t}_in_${d}/sharedNPCData`);return yield(0,u.Sm)((0,f.UN)(g,n),{name:n,hometown:r,imageURL:i,characterLink:l,characterInfo:s}),!0}catch(g){return console.log(g),null}})()}getCharacterData(t,n){var r=this;return(0,m.c)(function*(){const i=r.auth.currentUser,l=(0,u.gZ)(),s=(0,f.UN)(l,`npcs/from_${i.email}_in_${n}/NPCData`,t),d=yield(0,u.i4)(s);try{return d.exists()?d.data():(console.log("Kein Dokument mit dieser ID gefunden."),null)}catch(h){console.error("Fehler beim Abrufen des Dokuments:",h)}})()}getSharedCharacterData(t,n){var r=this;return(0,m.c)(function*(){const i=r.auth.currentUser,l=(0,u.gZ)(),s=(0,f.UN)(l,`npcs/from_${i.email}_in_${n}/sharedNPCData`,t),d=yield(0,u.i4)(s);try{return d.exists()?d.data():(console.log("Kein Dokument mit dieser ID gefunden."),null)}catch(h){console.error("Fehler beim Abrufen des Dokuments:",h)}})()}updateCharacter(t,n,r,i,l){var s=this;return(0,m.c)(function*(){const d=s.auth.currentUser;try{const h=(0,u.oV)(s.fireStore,`npcs/from_${d.email}_in_${l}/NPCData`),g=(0,f.UN)(h,i);return yield(0,u.gD)(g,{hometown:t,characterLink:n,characterInfo:r}),!0}catch{return null}})()}deleteDocument(t,n){var r=this;return(0,m.c)(function*(){const i=r.auth.currentUser;try{const l=(0,u.gZ)(),s=(0,f.UN)(l,`npcs/from_${i.email}_in_${n}/NPCData`,t);return yield(0,u.oh)(s),console.log("Document successfully deleted!"),!0}catch(l){return console.error("Error deleting document: ",l),!1}})()}deleteSharedDocument(t,n){var r=this;return(0,m.c)(function*(){const i=r.auth.currentUser;try{const l=(0,u.gZ)(),s=(0,f.UN)(l,`npcs/from_${i.email}_in_${n}/sharedNPCData`,t);return yield(0,u.oh)(s),console.log("Document successfully deleted!"),!0}catch(l){return console.error("Error deleting document: ",l),!1}})()}}return(a=c).\u0275fac=function(t){return new(t||a)(e.CoB(v.sL),e.CoB(f.OI),e.CoB(I.u_))},a.\u0275prov=e.wxM({token:a,factory:a.\u0275fac,providedIn:"root"}),c})();const x=["creationModalNPC"],$=["searchModalNPC"],M=["itemModalNPC"],Y=["alertModalNPC"];function w(a,c){if(1&a&&e.wR5(0,"img",25),2&a){const o=e.GaO().$implicit;e.E7m("src",o.imageURL,e.K6U)}}function S(a,c){1&a&&(e.I0R(0,"div",26),e.wR5(1,"img",27),e.C$Y())}function D(a,c){if(1&a&&(e.I0R(0,"ion-item")(1,"ion-label",28),e.OEk(2),e.C$Y()()),2&a){const o=e.GaO().$implicit;e.yG2(2),e.cNF(o.characterInfo)}}function U(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-item-sliding")(1,"ion-item",19)(2,"ion-avatar",20),e.qCj("click",function(){const r=e.usT(o).$implicit,i=e.GaO();return e.CGJ(i.changeImage(r))}),e.yuY(3,w,1,1,"img",21)(4,S,2,0,"ng-template",null,22,e.gJz),e.C$Y(),e.I0R(6,"ion-label"),e.OEk(7),e.C$Y(),e.I0R(8,"ion-label"),e.OEk(9),e.C$Y(),e.I0R(10,"ion-icon",23),e.qCj("click",function(){const r=e.usT(o).$implicit,i=e.GaO();return e.CGJ(i.setIndex(r))}),e.C$Y()(),e.yuY(11,D,3,1,"ion-item",24),e.C$Y()}if(2&a){const o=c.$implicit,t=e.Gew(5);e.yG2(),e.E7m("button",!0),e.yG2(2),e.E7m("ngIf",o.imageURL)("ngIfElse",t),e.yG2(4),e.cNF(o.name),e.yG2(2),e.cNF(o.hometown),e.yG2(2),e.E7m("ngIf",""!=o.characterInfo)}}function F(a,c){1&a&&(e.I0R(0,"p"),e.OEk(1,"Picture has been selected"),e.C$Y())}function K(a,c){1&a&&(e.I0R(0,"div",26)(1,"p"),e.OEk(2,"Choose a picture"),e.C$Y()())}function A(a,c){1&a&&(e.I0R(0,"ion-label",39),e.OEk(1,"Name is mandatory"),e.C$Y())}function L(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-content",29)(1,"div",30)(2,"form",31)(3,"ion-card")(4,"ion-card-header")(5,"ion-card-title"),e.OEk(6,"Create character note"),e.C$Y()(),e.I0R(7,"ion-card-content")(8,"ion-item",32),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.chooseImage())}),e.yuY(9,F,2,0,"p",33)(10,K,3,0,"ng-template",null,22,e.gJz),e.C$Y(),e.I0R(12,"ion-item"),e.wR5(13,"ion-input",34),e.C$Y(),e.yuY(14,A,2,0,"ion-label",35),e.I0R(15,"ion-item"),e.wR5(16,"ion-input",36),e.C$Y(),e.I0R(17,"ion-button",37),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.createNPC())}),e.OEk(18,"Create character"),e.C$Y(),e.I0R(19,"ion-button",38),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.cancelCreation())}),e.OEk(20,"Close"),e.C$Y()()()()()()}if(2&a){const o=e.Gew(11),t=e.GaO();let n;e.yG2(2),e.E7m("formGroup",t.createNPCForm),e.yG2(7),e.E7m("ngIf",t.photo)("ngIfElse",o),e.yG2(5),e.E7m("ngIf",(null==(n=t.createNPCForm.get("name"))?null:n.touched)&&(null==(n=t.createNPCForm.get("name"))||null==n.errors?null:n.errors.required)),e.yG2(3),e.E7m("disabled",!t.createNPCForm.valid)}}function j(a,c){if(1&a&&(e.I0R(0,"ion-select-option",45),e.OEk(1),e.C$Y()),2&a){const o=c.$implicit;e.E7m("value",o),e.yG2(),e.cNF(o)}}function q(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-content",29)(1,"div",30)(2,"form")(3,"ion-card")(4,"ion-card-header")(5,"ion-card-title"),e.OEk(6,"Search for NPC"),e.C$Y()(),e.I0R(7,"ion-card-content")(8,"ion-item"),e.wR5(9,"ion-searchbar",40,41),e.C$Y(),e.I0R(11,"ion-item")(12,"ion-select",42),e.iHE("ngModelChange",function(n){e.usT(o);const r=e.GaO();return e.kNx(r.selectedHometown,n)||(r.selectedHometown=n),e.CGJ(n)}),e.yuY(13,j,2,2,"ion-select-option",43),e.C$Y()(),e.I0R(14,"ion-button",44),e.qCj("click",function(){e.usT(o);const n=e.Gew(10),r=e.GaO();return e.CGJ(r.search(n.value))}),e.OEk(15,"Search"),e.C$Y(),e.I0R(16,"ion-button",38),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.cancelSearch())}),e.OEk(17,"Close"),e.C$Y()()()()()()}if(2&a){const o=e.GaO();e.yG2(12),e.OKB("ngModel",o.selectedHometown),e.yG2(),e.E7m("ngForOf",o.hometowns)}}function H(a,c){if(1&a&&(e.I0R(0,"ion-select-option",45),e.OEk(1),e.C$Y()),2&a){const o=c.$implicit;e.E7m("value",o.email),e.yG2(),e.cNF(o.email)}}function J(a,c){if(1&a){const o=e.KQA();e.I0R(0,"h3"),e.OEk(1,"Share NPC with user"),e.C$Y(),e.I0R(2,"ion-select",64),e.iHE("ngModelChange",function(n){e.usT(o);const r=e.GaO(2);return e.kNx(r.chosenUsers,n)||(r.chosenUsers=n),e.CGJ(n)}),e.yuY(3,H,2,2,"ion-select-option",43),e.C$Y(),e.I0R(4,"ion-button",65),e.qCj("click",function(){e.usT(o);const n=e.GaO(2);return e.CGJ(n.shareNPC())}),e.OEk(5,"Share"),e.C$Y()}if(2&a){const o=e.GaO(2);e.yG2(2),e.E7m("multiple",!0),e.OKB("ngModel",o.chosenUsers),e.yG2(),e.E7m("ngForOf",o.users)}}function B(a,c){if(1&a&&e.wR5(0,"img",25),2&a){const o=e.GaO(2);e.E7m("src",o.characterImg,e.K6U)}}function Q(a,c){1&a&&(e.I0R(0,"div",26),e.wR5(1,"img",27),e.C$Y())}function W(a,c){1&a&&(e.I0R(0,"ion-label",1),e.OEk(1,"Hometown: "),e.C$Y())}function z(a,c){if(1&a&&(e.I0R(0,"a",66),e.OEk(1),e.C$Y()),2&a){const o=e.GaO(2);e.yG2(),e.cNF(o.characterHome)}}function V(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-input",67),e.iHE("ngModelChange",function(n){e.usT(o);const r=e.GaO(2);return e.kNx(r.characterHome,n)||(r.characterHome=n),e.CGJ(n)}),e.C$Y()}if(2&a){const o=e.GaO(2);e.OKB("ngModel",o.characterHome)}}function Z(a,c){1&a&&(e.I0R(0,"ion-label",1),e.OEk(1,"Link:"),e.C$Y())}function X(a,c){if(1&a&&(e.I0R(0,"a",68),e.OEk(1),e.C$Y()),2&a){const o=e.GaO(2);e._6D("href",o.characterLink,e.K6U),e.yG2(),e.cNF(o.characterName)}}function ee(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-input",69),e.iHE("ngModelChange",function(n){e.usT(o);const r=e.GaO(2);return e.kNx(r.characterLink,n)||(r.characterLink=n),e.CGJ(n)}),e.C$Y()}if(2&a){const o=e.GaO(2);e.OKB("ngModel",o.characterLink)}}function te(a,c){if(1&a&&(e.I0R(0,"textarea",70),e.OEk(1),e.C$Y()),2&a){const o=e.GaO(2);e.yG2(),e.cNF(o.characterInfo)}}function ne(a,c){if(1&a){const o=e.KQA();e.I0R(0,"textarea",71),e.iHE("ngModelChange",function(n){e.usT(o);const r=e.GaO(2);return e.kNx(r.characterInfo,n)||(r.characterInfo=n),e.CGJ(n)}),e.OEk(1),e.C$Y()}if(2&a){const o=e.GaO(2);e.OKB("ngModel",o.characterInfo),e.yG2(),e.cNF(o.characterInfo)}}function ae(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-content",29)(1,"ion-fab",46)(2,"ion-fab-button",6),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.toggleEditModeNPC())}),e.wR5(3,"ion-icon",47),e.C$Y()(),e.I0R(4,"ion-fab",46)(5,"ion-fab-button",48),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.saveCharacterData())}),e.wR5(6,"ion-icon",49),e.C$Y()(),e.I0R(7,"ion-fab",50)(8,"ion-fab-button",51),e.wR5(9,"ion-icon",52),e.C$Y()(),e.I0R(10,"ion-popover",53),e.yuY(11,J,6,3,"ng-template"),e.C$Y(),e.I0R(12,"ion-card")(13,"ion-card-header")(14,"ion-card-title",54),e.OEk(15),e.C$Y()(),e.I0R(16,"ion-card-content")(17,"ion-avatar",55),e.yuY(18,B,1,1,"img",21)(19,Q,2,0,"ng-template",null,22,e.gJz),e.C$Y()(),e.I0R(21,"ion-card-content")(22,"ion-item"),e.yuY(23,W,2,0,"ion-label",56)(24,z,2,1,"a",57)(25,V,1,1,"ion-input",58),e.C$Y(),e.I0R(26,"ion-item"),e.yuY(27,Z,2,0,"ion-label",56)(28,X,2,2,"a",59)(29,ee,1,1,"ion-input",60),e.C$Y()()(),e.I0R(30,"ion-card")(31,"ion-card-header")(32,"ion-card-title"),e.OEk(33,"Additional Infos"),e.C$Y()(),e.I0R(34,"ion-card-content")(35,"ion-item"),e.yuY(36,te,2,1,"textarea",61)(37,ne,2,2,"textarea",62),e.C$Y()()(),e.I0R(38,"ion-button",38),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.cancelItem())}),e.OEk(39,"Close"),e.C$Y(),e.I0R(40,"ion-button",63),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.delete())}),e.OEk(41,"Delete"),e.C$Y()()}if(2&a){const o=e.Gew(20),t=e.GaO();e.yG2(),e.E7m("hidden",t.editMode),e.yG2(3),e.E7m("hidden",!t.editMode),e.yG2(3),e.E7m("hidden",t.editMode),e.yG2(3),e.E7m("isOpen",t.isPopoverOpen),e.yG2(4),e.CI5("id","nameNPC",t.currentItemIndexNPC,""),e.yG2(),e.cNF(t.characterName),e.yG2(3),e.E7m("ngIf",t.characterImg)("ngIfElse",o),e.yG2(5),e.E7m("ngIf",!t.editMode),e.yG2(),e.E7m("ngIf",!t.editMode),e.yG2(),e.E7m("ngIf",t.editMode),e.yG2(2),e.E7m("ngIf",!t.editMode),e.yG2(),e.E7m("ngIf",!t.editMode),e.yG2(),e.E7m("ngIf",t.editMode),e.yG2(7),e.E7m("ngIf",!t.editMode),e.yG2(),e.E7m("ngIf",t.editMode)}}function oe(a,c){if(1&a&&e.wR5(0,"img",25),2&a){const o=e.GaO().$implicit;e.E7m("src",o.imageURL,e.K6U)}}function re(a,c){1&a&&(e.I0R(0,"div",26),e.wR5(1,"img",27),e.C$Y())}function ie(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-item-sliding")(1,"ion-item",19)(2,"ion-avatar",73),e.yuY(3,oe,1,1,"img",21)(4,re,2,0,"ng-template",null,22,e.gJz),e.C$Y(),e.I0R(6,"ion-label",54),e.OEk(7),e.C$Y(),e.I0R(8,"ion-label"),e.OEk(9),e.C$Y(),e.I0R(10,"ion-icon",74),e.qCj("click",function(){const r=e.usT(o).index,i=e.GaO(2);return e.CGJ(i.addToDatabase(r))}),e.C$Y(),e.I0R(11,"ion-icon",75),e.qCj("click",function(){const r=e.usT(o).index,i=e.GaO(2);return e.CGJ(i.deleteShared(r))}),e.C$Y()()()}if(2&a){const o=c.$implicit,t=c.index,n=e.Gew(5);e.yG2(),e.E7m("button",!0),e.yG2(2),e.E7m("ngIf",o.imageURL)("ngIfElse",n),e.yG2(3),e.CI5("id","sharedNameNPC",t,""),e.yG2(),e.cNF(o.name),e.yG2(2),e.cNF(o.hometown)}}function ce(a,c){if(1&a){const o=e.KQA();e.I0R(0,"ion-content",29)(1,"h3",72),e.OEk(2,"Shared Characters"),e.C$Y(),e.I0R(3,"ion-list",12),e.yuY(4,ie,12,6,"ion-item-sliding",13),e.C$Y(),e.I0R(5,"ion-button",63),e.qCj("click",function(){e.usT(o);const n=e.GaO();return e.CGJ(n.cancelAlert())}),e.OEk(6,"Close"),e.C$Y()()}if(2&a){const o=e.GaO();e.yG2(3),e.E7m("inset",!0),e.yG2(),e.E7m("ngForOf",o.sharedNPCs)}}const le=[{path:"",component:(()=>{var a;class c{constructor(t,n,r,i){this.npcService=t,this.loadingController=n,this.alertController=r,this.formBuilder=i,this.searchItem="",this.selectedHometown="",this.chosenUsers=null,this.profile=null,this.npcs=null,this.sharedNPCs=null,this.users=null,this.filter=!0,this.editMode=!1,this.isPopoverOpen=!1,this.tempCharacterLink="",this.tempCharacterInfo="",this.currentGame=localStorage.getItem("currentGame"),this.npcService.getNPCs(this.searchItem,this.selectedHometown,this.currentGame).subscribe(l=>{this.npcs=l,this.hometowns=this.uniqueHometowns}),this.npcService.getEmails(this.currentGame).subscribe(l=>{this.users=l,console.log(l)}),this.npcService.getShared(this.currentGame).subscribe(l=>{this.sharedNPCs=l,this.sharedNPCCount=l.length})}ngOnInit(){this.createNPCForm=new E(this.formBuilder).createForm(),this.onWillDismiss(null)}ionViewWillEnter(){"true"===localStorage.getItem("reload")&&(localStorage.setItem("reload","false"),location.reload()),this.currentGame=localStorage.getItem("currentGame")}get uniqueHometowns(){if(!this.npcs)return[];const t=new Set;return this.npcs.forEach(n=>t.add(n.hometown)),Array.from(t)}search(t){this.npcService.getNPCs(t,this.selectedHometown,this.currentGame).subscribe(n=>{this.npcs=n}),this.selectedHometown="",this.cancelSearch(),setTimeout(()=>{this.filter=!this.filter},300)}changeImage(t){var n=this;return(0,m.c)(function*(){const r=yield y.Ut.getPhoto({quality:90,allowEditing:!1,resultType:y.on.Base64,source:y._8.Photos});if(r){const i=yield n.loadingController.create();yield i.present();const l=yield n.npcService.uploadImage(r,t.name,n.currentGame);i.dismiss(),l||(yield(yield n.alertController.create({header:"Upload failed",message:"There was a problem uploading your avatar.",buttons:["OK"]})).present())}})()}chooseImage(){var t=this;return(0,m.c)(function*(){t.photo=yield y.Ut.getPhoto({quality:90,allowEditing:!1,resultType:y.on.Base64,source:y._8.Photos})})()}createNPC(){var t=this;return(0,m.c)(function*(){const n=yield t.loadingController.create();yield n.present();const r=yield t.npcService.uploadNPC(t.createNPCForm.value.name,t.createNPCForm.value.hometown,null==t?void 0:t.photo,t.currentGame);t.photo=null,t.createNPCForm.reset(),n.dismiss(),r||(yield(yield t.alertController.create({header:"Upload failed",message:"There was a problem uploading your NPC.",buttons:["OK"]})).present()),t.cancelCreation()})()}toggleEditModeNPC(){this.editMode=!this.editMode}saveCharacterData(){var t=this;return(0,m.c)(function*(){const n=yield t.loadingController.create();yield n.present();const r=yield t.npcService.updateCharacter(t.characterHome,t.characterLink,t.characterInfo,t.characterName,t.currentGame);n.dismiss(),r||(yield(yield t.alertController.create({header:"Upload failed",message:"There was a problem uploading your data.",buttons:["OK"]})).present()),t.toggleEditModeNPC()})()}delete(){var t=this;return(0,m.c)(function*(){yield(yield t.alertController.create({header:"Are you sure?",message:"Data will be deleted",buttons:[{text:"Delete",handler:()=>{t.npcService.deleteDocument(t.npc.name,t.currentGame),t.cancelItem()}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}deleteShared(t){var n=this;return(0,m.c)(function*(){yield(yield n.alertController.create({header:"Are you sure?",message:"Data will be deleted",buttons:[{text:"Delete",handler:()=>{var i;const s=null===(i=document.getElementById("sharedNameNPC"+t))||void 0===i?void 0:i.textContent;n.npcService.deleteSharedDocument(s,n.currentGame),n.cancelItem()}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}setIndex(t){var n=this;return(0,m.c)(function*(){n.characterName=t.name,n.characterHome=t.hometown,n.characterImg=t.imageURL,n.characterInfo=t.characterInfo,n.characterLink=t.characterLink,n.npc=t,n.isItemModalOpenNPC=!0})()}setSharedIndex(t){var n=this;return(0,m.c)(function*(){var r;const l=null===(r=document.getElementById("sharedNameNPC"+t))||void 0===r?void 0:r.textContent,s=yield n.npcService.getSharedCharacterData(l,n.currentGame);console.log("Link: "+s.characterLink),n.characterName=s.name,n.characterHome=s.hometown,n.characterImg=s.imageURL,n.characterInfo=s.characterInfo,n.characterLink=s.characterLink})()}shareNPC(){var t=this;return(0,m.c)(function*(){const n=yield t.loadingController.create();yield n.present();try{t.chosenUsers.forEach(function(){var r=(0,m.c)(function*(i){i&&console.log(i),yield t.npcService.shareCharacter(i,t.characterName,t.characterHome,t.characterImg,t.characterLink,t.characterInfo,t.currentGame)});return function(i){return r.apply(this,arguments)}}())}catch{yield(yield t.alertController.create({header:"Couldn't share",message:"There was a problem sharing your data.",buttons:["OK"]})).present()}n.dismiss()})()}addToDatabase(t){var n=this;return(0,m.c)(function*(){var r;yield n.setSharedIndex(t);const i=yield n.npcService.uploadSharedNPC(n.characterName,n.characterHome,n.characterImg,n.characterLink,n.characterInfo,n.currentGame);var l="sharedNameNPC"+t;const s=yield null===(r=document.getElementById(l))||void 0===r?void 0:r.textContent;i&&(yield n.npcService.deleteSharedDocument(s,n.currentGame))})()}cancelCreation(){this.isCreationModalOpenNPC=!1,this.creationModalNPC.dismiss(null,"cancel")}cancelAlert(){this.isAlertModalOpenNPC=!1,this.alertModalNPC.dismiss(null,"cancel")}cancelSearch(){this.searchModalNPC.dismiss(null,"cancel")}cancelItem(){this.isItemModalOpenNPC=!1,this.itemModalNPC.dismiss(null,"cancel"),this.editMode&&this.toggleEditModeNPC()}openCreation(){this.isCreationModalOpenNPC=!0}openSearch(){this.isSearchModalOpenNPC=!0}openAlert(){this.isAlertModalOpenNPC=!0}onWillDismiss(t){this.isSearchModalOpenNPC=!1,this.isCreationModalOpenNPC=!1,this.isAlertModalOpenNPC=!1,this.isItemModalOpenNPC=!1}}return(a=c).\u0275fac=function(t){return new(t||a)(e.GI1(R),e.GI1(_.Kg),e.GI1(_.iW),e.GI1(C.im))},a.\u0275cmp=e.In1({type:a,selectors:[["app-tab1"]],viewQuery:function(t,n){if(1&t&&(e.CC$(x,5),e.CC$($,5),e.CC$(M,5),e.CC$(Y,5)),2&t){let r;e.wto(r=e.Gqi())&&(n.creationModalNPC=r.first),e.wto(r=e.Gqi())&&(n.searchModalNPC=r.first),e.wto(r=e.Gqi())&&(n.itemModalNPC=r.first),e.wto(r=e.Gqi())&&(n.alertModalNPC=r.first)}},decls:31,vars:11,consts:[[3,"translucent"],["slot","start"],["slot","end","color","danger",1,"badge-position"],["slot","end","name","notifications-outline",2,"height","35px","width","35px",3,"click"],[3,"fullscreen"],["slot","fixed","vertical","bottom","horizontal","end"],["color","secondary",3,"click"],["name","add-outline"],["slot","fixed","vertical","bottom","horizontal","start",3,"hidden"],["name","search-outline"],["color","danger",3,"click"],["name","remove"],[3,"inset"],[4,"ngFor","ngForOf"],[3,"isOpen","willDismiss"],["creationModalNPC",""],["searchModalNPC",""],["itemModalNPC",""],["alertModalNPC",""],[3,"button"],["aria-hidden","true","slot","start",3,"click"],[3,"src",4,"ngIf","ngIfElse"],["placeholder_avatar",""],["name","chevron-forward-outline",3,"click"],[4,"ngIf"],[3,"src"],[1,"placeholder"],["src","https://ionicframework.com/docs/img/demos/avatar.svg"],[1,"crop"],[1,"ion-padding"],[1,"flex-center"],[3,"formGroup"],[3,"click"],[4,"ngIf","ngIfElse"],["formControlName","name","label","Name","labelPlacement","floating","placeholder","Enter name","type","text"],["color","danger",4,"ngIf"],["formControlName","hometown","label","Hometown","labelPlacement","floating","placeholder","Enter hometown","type","text"],["color","dark","form","round",3,"disabled","click"],["color","danger","fill","outline",3,"click"],["color","danger"],["show-clear-button","focus","value",""],["searchBar",""],["label","Choose hometown","name","selectedHometown",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["color","dark","form","round",3,"click"],[3,"value"],["slot","fixed","vertical","bottom","horizontal","end",3,"hidden"],["name","create-outline"],["color","success",3,"click"],["name","save-outline"],["slot","fixed","vertical","top","horizontal","end",3,"hidden"],["id","open-popover","color","secondary"],["name","share-social-outline"],["trigger","open-popover",3,"isOpen"],[3,"id"],["aria-hidden","true",1,"align-center"],["slot","start",4,"ngIf"],["slot","end","style","text-decoration: none; pointer-events: none;","href","",4,"ngIf"],["placeholder","Type character hometown","type","text",3,"ngModel","ngModelChange",4,"ngIf"],["slot","end","style","text-decoration: none;",3,"href",4,"ngIf"],["placeholder","Type character link","type","text",3,"ngModel","ngModelChange",4,"ngIf"],["class","readonlyTextarea","rows","7","cols","55","readonly","",4,"ngIf"],["placeholder","Type character info","rows","40","cols","55",3,"ngModel","ngModelChange",4,"ngIf"],["color","danger","form","round",3,"click"],["label","Choose user","name","chosenUsers",3,"multiple","ngModel","ngModelChange"],["color","dark","fill","outline",3,"click"],["slot","end","href","",2,"text-decoration","none","pointer-events","none"],["placeholder","Type character hometown","type","text",3,"ngModel","ngModelChange"],["slot","end",2,"text-decoration","none",3,"href"],["placeholder","Type character link","type","text",3,"ngModel","ngModelChange"],["rows","7","cols","55","readonly","",1,"readonlyTextarea"],["placeholder","Type character info","rows","40","cols","55",3,"ngModel","ngModelChange"],[2,"display","flex","justify-content","center"],["aria-hidden","true","slot","start"],["slot","end","name","add-circle-outline",3,"click"],["slot","end","name","trash-outline",3,"click"]],template:function(t,n){1&t&&(e.I0R(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),e.OEk(3," Character Notes "),e.C$Y(),e.I0R(4,"ion-badge",2),e.OEk(5),e.C$Y(),e.I0R(6,"ion-icon",3),e.qCj("click",function(){return n.openAlert()}),e.C$Y()()(),e.I0R(7,"ion-content",4)(8,"ion-fab",5)(9,"ion-fab-button",6),e.qCj("click",function(){return n.openCreation()}),e.wR5(10,"ion-icon",7),e.C$Y()(),e.I0R(11,"ion-fab",8)(12,"ion-fab-button",6),e.qCj("click",function(){return n.openSearch()}),e.wR5(13,"ion-icon",9),e.C$Y()(),e.I0R(14,"ion-fab",8)(15,"ion-fab-button",10),e.qCj("click",function(){return n.search("")}),e.wR5(16,"ion-icon",11),e.C$Y()(),e.I0R(17,"ion-list",12),e.yuY(18,U,12,6,"ion-item-sliding",13),e.C$Y(),e.I0R(19,"ion-modal",14,15),e.qCj("willDismiss",function(i){return n.onWillDismiss(i)}),e.yuY(21,L,21,5,"ng-template"),e.C$Y(),e.I0R(22,"ion-modal",14,16),e.qCj("willDismiss",function(i){return n.onWillDismiss(i)}),e.yuY(24,q,18,2,"ng-template"),e.C$Y(),e.I0R(25,"ion-modal",14,17),e.qCj("willDismiss",function(i){return n.onWillDismiss(i)}),e.yuY(27,ae,42,16,"ng-template"),e.C$Y(),e.I0R(28,"ion-modal",14,18),e.qCj("willDismiss",function(i){return n.onWillDismiss(i)}),e.yuY(30,ce,7,2,"ng-template"),e.C$Y()()),2&t&&(e.E7m("translucent",!0),e.yG2(5),e.cNF(n.sharedNPCCount),e.yG2(2),e.E7m("fullscreen",!0),e.yG2(4),e.E7m("hidden",!n.filter),e.yG2(3),e.E7m("hidden",n.filter),e.yG2(3),e.E7m("inset",!0),e.yG2(),e.E7m("ngForOf",n.npcs),e.yG2(),e.E7m("isOpen",n.isCreationModalOpenNPC),e.yG2(3),e.E7m("isOpen",n.isSearchModalOpenNPC),e.yG2(3),e.E7m("isOpen",n.isItemModalOpenNPC),e.yG2(3),e.E7m("isOpen",n.isAlertModalOpenNPC))},dependencies:[_.O7,_.Gi,_.sn,_.KC,_.Gg,_.YY,_.I7,_._i,_.q8,_.Wq,_.wB,_.Ko,_.A5,_.Yb,_.UB,_.QR,_.OC,_.KQ,_.Cy,_.gd,_.tM,_.Md,_.yc,_.sW,_.IT,_.qG,T.ay,T.u_,C.sz,C.ot,C.ue,C.u,C._G,C.SC,C.uW,C.Wo],styles:[".center[_ngcontent-%COMP%]{display:flex;justify-content:center}.readonlyTextarea[_ngcontent-%COMP%]{resize:none;width:100%;height:100%}"]}),c})()}];let se=(()=>{var a;class c{}return(a=c).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({imports:[N.qQ.forChild(le),N.qQ]}),c})(),_e=(()=>{var a;class c{}return(a=c).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.a4G({type:a}),a.\u0275inj=e.s3X({imports:[_.wZ,T.MD,C.y,k.C,se,C.sl]}),c})()}}]);